### 服务端渲染结合 redux 总结

传统的 SPA 应用的 redux 使用方式比较简单，只需要在组件的最外层使用 provider 进行 store 的提供就行了，在 ssr 中由于有服务端的预渲染，情况会比较不一样，结合 next-redux-wrapper 说明一下自己理解的渲染流程

redux 的服务端渲染分为两个部分，服务器初始化阶段 -> 本地浏览器接管阶段

1. 服务器对于每一个新的请求都会生成使用初始化方法生成一个新的 store，如果在服务端使用了 dispatch 方法，则会首先初始化一个新的 store，再执行这个 dispatch 的 action 操作，最后会触发本地的 HYDRATE 方法，与本地的 store 进行合并，生成本次新的 state
2. 如果只是在浏览器端执行的 dispatch 方法，则不会对服务器端造成任何影响

### 设计

1. 使用服务器端与客户端分离的 state 结构，每次进行 HYDRATE 时会将服务器端的最新数据同步到 client 端的 state 中

2. 服务器端的初始化使用之前为每一个用户绑定的session中获取，实现每一个用户当前状态的保存与恢复

3. 使用特定接口向服务器端传递当前需要保存的状态，用户相关的存储在数据库中
